# ===============================================
# Project: delta-backup configuration
# Author: Max Haase â€“ maxhaase@gmail.com
# ===============================================

# The [delta] section contains all configuration keys for delta-backup.
[delta]  # BEGIN delta section

backup_root = /STORE/BACKUP/             # Root directory that contains all repositories (must exist; absolute path)
host_repo   = /STORE/BACKUP/host-backup # Absolute path to the host repository (must exist)
vm_repo     = /STORE/BACKUP/vm-backup   # Absolute path to the VM repository (must exist)

host_passfile = /home/delta/.config/delta/host.pass # File containing passphrase for the HOST repo (read via `cat`)
vm_passfile   = /home/delta/.config/delta/vm.pass   # File containing passphrase for the VM repo (read via `cat`)

host_excludes = /proc,/sys,/dev,/run,/tmp,/var/tmp,/lost+found,/mnt,/media,/SWAPFILE,/var/lib/libvirt/images,/var/cache,/var/lib/apt/lists,/var/cache/apt/archives,*/.cache  # Comma/newline separated list of paths to exclude from HOST backup
extra_paths =                           # Comma/newline separated list of extra paths to back up as separate archives (can be empty)
extra_prefix = extra                    # Prefix used for extra path archives (combined as {hostname}-{extra_prefix}-{index})

enable_prune = false                    # Whether to prune old archives after backups (true/false/yes/no/on/off/1/0)
prune_keep_daily = 90                   # Retention: keep this many daily archives when pruning
prune_keep_weekly = 4                   # Retention: keep this many weekly archives when pruning
prune_keep_monthly = 6                  # Retention: keep this many monthly archives when pruning

enable_compact = true                   # Whether to compact repositories to reclaim space after run (true/false/etc.)

vm_shutdown_timeout = 600               # Seconds to wait for a VM to shut down gracefully before forcing
vm_startup_grace = 5                    # Seconds to wait after starting a VM before proceeding

lock_file = /var/lock/delta-backup.lock # Lock file used to prevent concurrent runs (must be writable by root)
lock_wait = 120                         # Seconds the engine should wait to acquire repository locks
require_mountpoint = false              # If true, backup_root must be an actual mountpoint (useful for removable disks)

engine_bin = borg                       # Underlying engine command used to perform backups (e.g., borg)
engine_compression = zstd,6             # Engine compression setting (engine-native syntax)
engine_filter = AME                     # Engine listing filter (engine-native value, e.g., AME)
engine_one_file_system = true           # If true, restrict archive to a single filesystem (engine flag)
engine_files_cache = ctime,size,inode   # Engine files cache mode (improves change detection)

# Installer-only: user and group that will own backup config and repos
delta_user = delta                      # System user that will own config, initialize repos, and run optional UI
delta_group = backup                    # System group that should have read/write access to backup locations

# END delta section
